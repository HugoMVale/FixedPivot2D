








FUNCTION COAGKERNEL(x1,y1,x2,y2,time)

!----------------------------------------------------------------------------------------------
!
!Coagulation kernel. To adapt as necessary.
!
!----------------------------------------------------------------------------------------------

USE GLOBAL

IMPLICIT NONE

!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

DOUBLE PRECISION, INTENT (IN) :: x1, y1, x2, y2, time
DOUBLE PRECISION :: COAGKERNEL


DOUBLE PRECISION, PARAMETER :: B0=1.0d0
DOUBLE PRECISION :: v1, v2, eff, fx1, fx2, e11=0.8d0, e22=0.1, e12=0.6d0

!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

v1 = x1 + y1
v2 = x2 + y2

fx1 = x1/v1
fx2 = x2/v2

eff = 1.0d0 !e11*fx1*fx2 + ((1.0d0-fx1)*fx2 + fx1*(1.0d0-fx2))*e12 + (1.0d0-fx1)*(1.0d0-fx2)*e22


COAGKERNEL = B0 !*eff*(2.0d0 + (v1/v2)**(1.0d0/3.0d0) + (v2/v1)**(1.0d0/3.0d0))

END FUNCTION COAGKERNEL
!##############################################################################################
